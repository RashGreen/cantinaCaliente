<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Waitlist</title>
     <!--Set up the links to bootstrap as well as setting up the scripts to activate jQuery in order to activate bootstrap-->
     <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
     <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
     <script src="https://code.jquery.com/jquery.js"></script>
     <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="jumbotron">
            <h1 class="text-center">Cantina Caliente Waitlist</h1>
            <hr>
            <h1 class="text-center">Welcome to the waitlist</h1>
    <div class="row">
        <div class="container">     
                <a href="/reservation.html"><button class="btn btn-lg btn-primary" class="text-center"><span class="fa fa-eye"></span>Request a Reservation</button></a>Â 
                <br>
        </div>
<!--create a space for the current reservations-->
        <div class="container">
            <div class="card">
                <div class="header">
                    <h2 class="text-center">Current RESOs</h2>
                </div>
                <div class="card-body">
                    <ul id="tableList" class="list-group"></ul>
                </div>
            </div>
        </div>
<!--create a space for the waitlist-->
        <div class="container">
                <div class="card">
                    <div class="header">
                        <h2 class="text-center">Current Waitlist</h2>
                    </div>
                    <div class="card-body">
                        <ul id="waitlist" class="list-group"></ul>
                    </div>
                </div>
            </div>
<footer class="bottom">
        <br>
        <div class="container" class="row">
            <div class="col-sm"></div>
            <div class="col-sm">Cantina Inc.|</div>
            <div class="col-sm"><a href="/waitlist/API">|Waitlist API|</a></div>
            <div class="col-sm"><a href="/reservation/API">|Reservations API|</a></div>
        </div>
        <br>
</footer>
</body>


<script type="text/javascript">

function tableQuery() {
    $.ajax({url: "/api/tables", method: "GET"})
    .then(function(tableData) {
        console.log(tableData);
        console.log('~~~~');

        for (var i = 0; i < tableData.length; i++){
            var tableList = $("#tableList")
            var listItem = $("<li class='list-group-item mt-4'>");
                listItem.append(
                    $("<h2>").text("table #" + (i + 1)),
                        $("<hr>"),
                        $("<h2>").text("ID: " + tableData[i].customerID),
                        $("<h2>").text("Email: " + tableData[i].customerEmail),
                        $("<h2>").text("Name: " + tableData[i].customerName),
                        $("<h2>").text("Phone # " + tableData[i].phoneNumber)                                                
                );
                tableList.append(listItem);
        }
        
        
    });
}

function theWaitList() {
    $.ajax({ url: "/api/waitlist", method: "GET"})
        .then(function(waitData){
            console.log(waitData);
            console.log('~~~~~~~~~~~~~~~~~~');
            for (var i=0; i < waitData.length; i++) {
                var waitList = $("#waitList");
                var listItem = $("<li class='list-group-item mt-4");
                listItem.append(
                    $("<h2>").text("table #" + (i + 1)),
                        $("<hr>"),
                        $("<h2>").text("ID: " + tableData[i].customerID),
                        $("<h2>").text("Email: " + tableData[i].customerEmail),
                        $("<h2>").text("Name: " + tableData[i].customerName),
                        $("<h2>").text("Phone # " + tableData[i].phoneNumber)                                                
                );
                tableList.append(listItem);
            } 
        });
}

function clearTable() {
    alert("Wiping the table clean.");

    $.ajax({url: "/api/clear", method: "POST"}).then(function() {
        $("#waitList").empty();
        $("#tableList").empty();
    });
}
$("#clear").on("click", clearTable);

tableQuery();
theWaitList();
</script>

</html>